<details>



<summary>Research Context</summary>

# GBMF Phase 6 Aquaculture and Coastal Habitats Mapping for 2024
In support of the Gordon and Betty Moore Foundation's Oceans and Seafood Markets Initiative, Clark CGA has mapped an inventory of pond aquaculture and coastal habitats in top-producing countries in the global tropics using satellite imagery. The focus of this project is to monitor the rapid development of brackish shrimp aquaculture ponds and the resulting impacts on mangroves and other coastal wetlands through land change analysis. These maps are used by stakeholders worldwide to understand the spatiotemporal transition dynamics of aquaculture and coastal ecosystems to help support conservation practices and sustainability crediting in the seafood industry. 



![image](https://github.com/user-attachments/assets/45e59976-76b7-4135-99aa-d6e91d37af53)
Landsat 8 false color composite (left) of aquaculture ponds in Guayaquil, Ecuador compared to landcover map product for year 2022 (right). 



![image](https://github.com/user-attachments/assets/b3008db4-a496-4b3f-bb58-933dc12589a6)
Land change analysis for Samarinda Delta, Indonesia from 1999 - 2022 showing striking transitions from mangrove to pond aquaculture in red.



Landcover maps are produced at 15-meter resolution for 17 pantropical countries (Bangladesh, Brazil, Cambodia, China, Ecuador, El Salvador, Honduras, India, Indonesia, Malaysia, Mexico, Myanmar, Nicaragua, Philippines, Sri Lanka, Thailand, and Vietnam) for the years 1999, 2014, 2018, 2020 and 2022 (2024 in progress). The legend categories include Mangroves, Other Coastal Wetlands, Pond Aquaculture, Open Water and Other. Landcover maps for 2014 onwards are developed using pansharpened Landsat 8/9 OLI imagery, supplemented with Sentinel-1 and Sentinel-2 data where necessary (typically in cloudier regions). Landcover maps for 1999 are based on Landsat 5 ETM+ imagery. Data is provided in raster format and distributed as compressed GeoTIFF files. All data are provided using a custom equal-area global reference system that follows the specifications listed below (INSERT REF SYSTEM PARAMETERS)



![quads_global](https://github.com/user-attachments/assets/8d13df36-b913-4d59-be03-f37060034cd7)
Distribution of over 600 Landsat quads analyzed to map 17 countries.

</details>



<details>

<summary>Quad List</summary>

Ecuador	2024				No. Scenes	6
					Complete	0
					% Complete	0.00%
Path/Row	Analyst	Date Completed	Notes			
10_59						
10_62						
11_59						
11_60						
11_61						
11_62						
						
Total		Total				
6		0				
						
						
						
Indonesia	2024				No. Scenes	198
					Complete	0
					% Complete	0.00%
Path/Row	Analyst	Date Completed	Notes			
100_65						
100_66						
101_62						
101_64						
101_65						
101_66						
102_61						
102_62						
102_63						
102_64						
102_65						
102_66						
103_61						
103_62						
103_63						
103_64						
104_61						
104_62						
104_63						
104_64						
104_65						
105_60						
105_61						
105_62						
105_63						
105_64						
105_65						
106_60						
106_61						
106_62						
106_63						
106_64						
106_65						
106_66						
107_60						
107_61						
107_62						
107_63						
107_65						
107_66						
108_60						
108_61						
108_62						
108_63						
108_65						
108_66						
109_58						
109_59						
109_60						
109_61						
109_62						
109_63						
109_65						
109_66						
110_58						
110_59						
110_60						
110_61						
110_62						
110_63						
110_65						
110_66						
110_67						
111_57						
111_58						
111_59						
111_61						
111_64						
111_66						
111_67						
111_68						
112_57						
112_59						
112_60						
112_61						
112_62						
112_63						
112_64						
112_65						
112_66						
112_67						
113_59						
113_60						
113_61						
113_62						
113_63						
113_64						
113_65						
113_66						
113_67						
114_59						
114_60						
114_61						
114_62						
114_63						
114_64						
114_66						
114_67						
115_59						
115_60						
115_61						
115_62						
115_65						
115_66						
116_57						
116_58						
116_59						
116_60						
116_61						
116_62						
116_63						
116_64						
116_65						
116_66						
117_57						
117_58						
117_60						
117_61						
117_62						
117_63						
117_64						
117_65						
117_66						
118_62						
118_63						
118_64						
118_65						
118_66						
119_62						
119_63						
119_64						
119_65						
119_66						
120_62						
120_64						
120_65						
120_66						
121_59						
121_60						
121_61						
121_62						
121_64						
121_65						
122_57						
122_58						
122_59						
122_60						
122_61						
122_62						
122_64						
122_65						
123_57						
123_58						
123_59						
123_60						
123_61						
123_62						
123_63						
123_64						
123_65						
124_58						
124_59						
124_60						
124_61						
124_62						
124_63						
124_64						
125_59						
125_60						
125_61						
125_62						
125_63						
125_64						
126_59						
126_60						
126_61						
126_62						
126_63						
127_58						
127_59						
127_60						
127_61						
127_62						
128_58						
128_59						
128_60						
128_61						
129_57						
129_58						
129_59						
129_60						
130_56						
130_57						
130_58						
130_59						
131_56						
131_57						
131_58						
						
Total		Total				
198		0				
						
						
						
Myanmar	2024				No. Scenes	23
					Complete	0
					% Complete	0.00%
Path/Row	Analyst	Date Completed	Notes			
130_50						
130_51						
130_52						
130_53						
130_54						
131_48						
131_49						
131_50						
131_51						
131_52						
132_48						
132_49						
133_48						
133_49						
134_46						
134_47						
134_48						
134_49						
134_50						
135_45						
135_46						
135_47						
136_45						
						
Total		Total				
23		0				
						
						
						
Thailand	2024				No. Scenes	21
					Complete	0
					% Complete	0.00%
Path/Row	Analyst	Date Completed	Notes			
127_52						
127_55						
127_56						
128_51						
128_52						
128_54						
128_55						
128_56						
129_50						
129_51						
129_52						
129_53						
129_54						
129_55						
129_56						
130_50						
130_51						
130_52						
130_53						
130_54						
130_55						
						
Total		Total				
21		0				
						
						
						
Vietnam	2024				No. Scenes	27
					Complete	0
					% Complete	0.00%
Path/Row	Analyst	Date Completed	Notes			
123_50						
123_51						
123_52						
123_53						
124_49						
124_50						
124_52						
124_53						
124_54						
125_45						
125_46						
125_48						
125_49						
125_52						
125_53						
125_54						
126_45						
126_46						
126_47						
126_48						
126_53						
126_54						
127_45						
127_46						
127_47						
127_53						
127_54						
						
Total		Total				
27		0				

  
</details>



<details>
  
<summary>Training Resources</summary>

# DIGITIZE Tutorial

* Data for DIGITIZE tutorial can be downloaded from this repo (tutorial_data.zip)

## Setting Up a New Project

* Launch TerrSet by clicking on the desktop icon or searching the application in Start menu on machine. This will load the liberaGIS splash screen on your monitor.

* Once loaded, locate the TerrSet Explorer panel on the left side of the screen. Here you can revisit previous projects, create new projects, and delete projects. Users can also assign their working and resource folders in the Explorer panel. The working folder is the default location for files created within TerrSet, while the resource folders are designed to help users organize their input data. 

* Right click in the Explorer panel and click New Project (alternatively press “Insert”). Within the digitize folder, locate the ecuador subfolderfolder downloaded for this tutorial and press OK. You will now see the ecuador project in your Explorer panel.

* The working folder is the folder where all new outputs will be created. Navigate to the working subfolder within the Ecuador folder using the pick list option. 

* Right click and add a resource folder and navigate to the resource subfolder within the ecuador data. This folder hosts the input data for this tutorial. 



![image](https://github.com/user-attachments/assets/c7acc56e-cbe2-4e7b-8d54-600de27948b8)



## Landsat Imagery

* Navigate to TerrSet Explorer (left side panel) and locate Files tab. Here you will see your working and resource folders. Within resource folder, click on the file labeled landsat8_false_color_composite to launch the raster image in TerrSet display. 

* User the cursor to explore the raster layer. This image is a Landsat 8 false color composite (bands 4,6,5) of a region in Ecuador where the ponds (blue/black) can be seen mosaicked across mangrove forests, which appear in a striking orange color. This will serve as a test area for this training module. 

* TerrSet comes with many useful shortcuts. To quickly zoom to the full extent of the selected raster layer, press the “Home” button. To quickly maximize the Display window on screen press “End”

* With the image selected in the composer window, press “Control+g” to launch the bounding box of the display window in Google Earth. This is an effective way to cross-reference the GIS images with Google Earth time series data to understand the landscape dynamics.



![image](https://github.com/user-attachments/assets/8d498e2e-88b4-4050-b20c-7eb9c3327f80)



## Landcover Classification

* In the resources folder you will see landcover_2024. Add this to composer display window in the following ways 
      * Right-clicking the file in Explorer and adding layer(s)
      * Dragging and dropping the image into the composer window (note this only works if the images have the same reference parameters)
      * With the layer highlighted in Explorer click Shift+Insert
      * Press “r” with composer window highlighted to launch add raster layer and locate the file using the picklist option 

* Change the palette by clicking the yellow and black checkered box in the composer window next to file name and clicking on the picklist option that pops up. Locate the file labeled Legend_Aquaculture to change the palette. This palette has been custom made for our map data to easily render the classes of interest. To view the image categories, right click on the display window and select map properties. Within the Map Properties form, select legends tab and click the radio button to make the legend 1 visible. You will now see the five categories in the display window (Mangrove, Coastal Wetlands, Pond Aquaculture, Water, Other). 

* Explore this map compared to the false color composite by toggling the layers on and off in the composer by clicking on the red check mark. As a hot key, try pressing “w” to toggle the top raster in composer on and off. To see and customize other hot keys, go to File > User Preferences > Hotkeys in the top left corner.



![image](https://github.com/user-attachments/assets/e83aa4f5-b36b-46d3-b45f-bbbfbd54f615)



## DIGITIZE Module

* As can be seen, this landcover map has some noticeable errors and revisions that need to be made. To streamline the process of editing raster maps and vector files, TerrSet provides users the DIGITIZE module.

* To access the DIGITIZE module, users can select the DIGITIZE icon in the toolbar (red and yellow crosshair) when a display window is open. Traditionally, the DIGITIZE module was used to help users create vector layers, often for the purpose of drawing training sites. For this tutorial, we will be focusing on the option to use vector features to update raster image(s). 

* Click the radio button to make this option visible and note the 4 options available (All pixels within digitized features, One class within digitized features, Use mask file, Overlay cover digitized features with raster image). This tutorial will explore each of these and examples of when to apply the different options.



![image](https://github.com/user-attachments/assets/2a75bd16-7ffc-4602-b2c1-87b0d45e7bc7)



## DIGITIZE - All pixels within digitized features

* The first option, and often most utilized for our work, is to digitize all pixels within a digitized feature – that is to say that all pixels that overlap with the features digitized by the user will be updated with the respective new value. This is most often used when new features need to be manually drawn into the map (e.g. adding a new ponds, removing errors, etc.) We will now use this option to add ponds to the map

* Start by zooming in on the region of the map that is shown below. Once located, use the blend layer option in composer on the landcover map to reveal the landsat image below it. As can be seen, a new pond is present in the imagery, but is not reflected in our landcover mapping – let’s update this.



![image](https://github.com/user-attachments/assets/cf6c8ed4-2533-432b-8697-e57c72a604a5)



* With the landcover raster layer highlighted in the composer, click on the DIGITIZE icon and select the option to use vector features to update raster layer(s).  

* At the top of the form is the option to name the file – let’s call this file “add_pond” as we will be using it to add the pond aquculture category to our map and overwrite whatever the class was previously underneath the features drawn by the user.

* Layer type and palette for the vector layer can be left as the defaults (polygon, Qual)

* The New class ID option is very important. This is the class value that will be newly assigned during the update process. As we are adding ponds to our map (class 3) we can change this value to 3.

* The raster layer(s) to update option is also important – this is the raster image in your composer that will have the updates applied to. In our case we are updating the landcover_2024 raster, so make sure that is the layer highlighted (NOTE – this often leads to errors so make sure you are updating the correct layers with the correct values in application of quad editing)

* Select the first option (All pixels within digitized features) and press OK. This will launch the digitize tool by adding the vector layer to your composer and changing your cursor to a crosshair. At this point you are in DIGITIZE mode.



![image](https://github.com/user-attachments/assets/e46153f7-378e-4821-b36b-07f1d9484d25)



* While in DIGITIZE mode, the cursor will function as  crosshair that allows users to draw polygons onto their window, which will in turn be the vector features within which updates are applied. To start drawing a polygon, click on the map to where the boundaries of the pond system can be seen and start building out a polygon with each vertices added. Right clicking will end the polygon by connecting to the first vertex. Holding Shift key will allow the user to continuously draw the polygon (much like a pencil).

* Using the options shown above, draw out the aquaculture ponds to be updated in the map. Once completed, the polygon feature should appear on screen. 



![image](https://github.com/user-attachments/assets/b2e2dae6-fc57-4553-a8b6-4e5575e8167d)



* At this point, we could update the raster layer using the Save Digitized Data option (Red arrow next to Red X in toolbar). However, for training purposes we will explore how to delete polygons if mistakes are made (this often happens)

* With the add_pond vector layer highlighted in composer, click on the polygon with your cursor. You will see it selected on screen with the ID value (3). To delete the polygon, click the Red X in the toolbar (delete feature). Alternatively, press the “Delete” key with the feature selected on screen. As can be seen, the polygon feature has been successfully deleted from the vector layer.

* Now let’s get back to our task of adding ponds. To continue editing the raster as before, highlight the layer in composer and then press the DIGITIZE logo and select “continue to digitize features to update layer with.” Alternatively, press the “d” key with the layer selected in composer to quickly start digitizing again (this is another useful hot key that will make this process faster for the user).

* Draw in the new pond system as before, but this time press the red arrow icon in the toolbar (Save Digitized Data). When prompted to update the layer, press OK. The landcover map will now be updated with the new ponds and visible on screen.



![image](https://github.com/user-attachments/assets/9ec7c6f2-c0c1-4823-babb-af68d0bfb551)



## DIGITIZE - One class within digitized features

* Updating all features within drawn polygons is very useful, but sometimes you want to have more control over which features get updated, rather than an all-inclusive update. This presents itself contextually, but is still an essential option to know. Let’s explore a case where updating only a single class with the digitized features is the most efficient way to add changes

* Locate the region shown below – this is an area where the map is wrongfully categorizing mangrove (1) patches as water (4). When compared to the imagery, it is clear this is an artifact of map error and not the actual landscape.



![image](https://github.com/user-attachments/assets/d535bc52-3b4a-4ee4-a897-56d9311b2ae2)



* While we could update this using the option before (All pixels within digitized features), it would be awfully tedious and have a larger margin for user error. This is a perfect opportunity to use our second DIGITZE option (One class within digitized feature)

* Similar to before, highlight the landcover_2024 raster layer in composer and press the DIGITIZE icon (alternatively press “d”). Within the DIGITIZE form, change the name of the layer to be created to be “water_to_pond” and select update vector features to update raster layer(s) option. Change the new class ID to be 1 for mangroves and indicate the second option to be used (One class within digitized feature). The original ID value can be changed to 4 (water) as this is the class value we are updating (therefore, no other values besides 4 will be updated with the new value of 1 within our digitized features)



![image](https://github.com/user-attachments/assets/19c200b2-3a15-4360-9ca6-044be0ee0c0c)



* Press OK to launch the DIGITIZE mode. All the same controls as before apply, but the way in which the raster layer gets updated will be different. Unlike the first option, this option will allow us to generally circle the water classes to update to mangrove, without having to be sensitive of the other classes (as the only class to be updated within the features is 4).

* Draw a bounding polygon around the water in this area and close the feature.



![image](https://github.com/user-attachments/assets/fb235ac2-f946-4c1f-8e7d-1970fd97feb4)



* Press the Save Digitized Data icon and look at the landcover map. We have now successfully updated the water errors to mangrove, without sacrificing any of the other classes. 



![image](https://github.com/user-attachments/assets/cf02f8e8-e01d-4205-8520-281a66974ff7)



## DIGITIZE - Use mask file
 

* Often when digitizing, the need to restrict the updates to a certain region (as opposed to a certain class like the previous step) occurs. This can be for a variety of reasons (working on the edge of maps, updating from a pre-existing boolean image, etc.) and often leads to the need for a mask. This is the next option in the DIGITIZE module we will explore.

* Zoom in on the northwest corner of the map to the area shown below.



![image](https://github.com/user-attachments/assets/07c22dc6-3061-4300-81a7-55038658a4d1)



* As can be seen, there are errors in the map that appear as mangroves (1) and pond aquaculture (3) but are really other (5) in reality. Let’s fix this problem.

* One way we could fix this would be to digitize all these polygons by hand (option 1) but that would not only be time consuming, it would also leave room for error along the edge (we do not want to add areas into the map as categories when they should be background)

* Option 2 would allow us to update only certain classes within the digitized features, but we would need to run that twice (once for class 1 and once for class 3)

* This leads us to option 3, Updating using a mask file. This is an excellent example of when we would use this option as we are looking to update values along the edge of the map, but do not want to bleed outside the study area. 

* Go to the resource folder and add the mask to this composer window. Use the blend layer option in composer to compare the mask to the landcover_2024 map. Notice how this is a boolean raster image that has pixel values of 1 where we have map data and 0 where we do not (background). This is an appropriate map to use as a mask file.



![image](https://github.com/user-attachments/assets/69bf5d8b-cee8-4158-a834-ead114f020ba)



* Highlight the landcover_2024 raster in composer and launch the DIGITIZE form. Select the option to use vector features to update raster layer(s) and change the created layer name to be “add_other_masked.” Change the New class ID to be 5 (other) and select the third option (use mask file). Here you identify the mask layer by typing the name, choosing the file from the picklist option, or dragging and dropping the layer into the text box.



![image](https://github.com/user-attachments/assets/e4143873-de6c-402f-98ee-d8dc0dbd15bc)



* Press OK and digitize following the same controls as before. As we are updating all values within the mask we indicated, we should be able to easily circle the erroneous classes along the edge in one polygon, and update all values to the proper masked extent.



![image](https://github.com/user-attachments/assets/d92e2b26-0e74-4a37-84b4-55ebd5cafbd9)



* Once you have completed the polygon feature to update, press the Save Digitized Data (Red Arrow in toolbar) and update the raster image. The map will now properly display the category Other (5) along the edge of the map (without any bleeding outside the masked area)



![image](https://github.com/user-attachments/assets/cf71a744-cec9-4960-bc58-2f2c83f28a8f)



## DIGITIZE - Overlay cover digitized features with raster image



* The last option available to users is the Overlay cover digitized features with raster image. This is the option you will use the least for this research, but it is still important to know. This option allows users to cover the current image with ALL the classes of a different raster image that are within the digitized regions (i.e. to overlay cover one map on top of the other within the digitized regions). This can be helpful when you have a reference map that you are trying to cover on top of the edited map in specific areas.

* Zoom to the region shown in the display below. Notice how we are missing an entire chunk of the landcover map – this is a great case study for the fourth digitize option.

  

![image](https://github.com/user-attachments/assets/c7655320-a0b4-40ba-a485-08436c87a940)



* This tutorial includes a reference map that can be used to update the existing image you are editing. Add the file missing_landcover_2024 to your composer and toggle the transparency option in composer (right side of composer next to blue channel box) – notice how it provides the missing information we need (note, unless you are using the same palette it will appear in the default colors, but the values are correct)



![image](https://github.com/user-attachments/assets/1ee45969-d04d-4740-9787-1fb10357e9b0)



* Highlight the landcover_2024 raster in composer and launch the digitize form (note, make sure to highlight the correct raster as you should have multiple in your composer now) Select the option to use vector features to update raster layer(s). Name the file to be created add_cover and make sure the raster layer to be updated is landcover_2024. Select the fourth option (Overlay cover digitized features with raster image) and locate the missing_landcover_2024 image through the picklist, drag and drop, or typing in the short name



![image](https://github.com/user-attachments/assets/ddb56fd5-f525-466b-a0ca-b0ba7e94660a)



* Press OK and begin digitizing. We can cover the missing map on our existing landcover map for updates by circling it with a digitize feature.



![image](https://github.com/user-attachments/assets/b14b2342-a87a-4c9a-a97b-a22a8b55661a)



* Once finished digitizing, press Save Digitized Data (Red Arrow in toolbar) and OK to updated the raster image. The raster layer will now be updated with the missing information from the reference map.



![image](https://github.com/user-attachments/assets/5c36b4bd-22ea-4974-a584-de0aeea22741)



</details>
